# MCP Memory - Production Environment Configuration
# Copy this file to .env.production and configure for your environment

# ============================================================================
# SERVICE CONFIGURATION
# ============================================================================

# MCP Endpoint Configuration
# Hostname or IP of the ChromaDB service (use service name in Docker network)
MCP_ENDPOINT=chroma

# Version tag for the application (used in docker-compose)
VERSION=1.0.0

# ============================================================================
# MEMORY POLICY CONFIGURATION
# ============================================================================

# Minimum confidence score for recalled memories (0.0 - 1.0)
# Higher values = more selective, only high-confidence memories
# Lower values = more inclusive, may include less relevant memories
MEMORY_CONFIDENCE_MIN=0.7

# Number of recent conversation messages to include in context
# Controls the "working memory" size
# Higher values = more conversation history in context
HISTORY_TAIL_N=16

# Number of top memories to retrieve from vector database
# Higher values = more memories considered, but slower
MEMORY_TOP_K=8

# Maximum number of memories to include per context window
# Prevents context from being overwhelmed by memories
MEMORY_MAX_PER_WINDOW=3

# Optional: Maximum token budget for context assembly
# Uncomment to enable token-based context limiting
# CONTEXT_TOKEN_BUDGET=4000

# ============================================================================
# LOGGING CONFIGURATION
# ============================================================================

# Logging level: DEBUG, INFO, WARNING, ERROR, CRITICAL
# Production recommendation: INFO or WARNING
LOG_LEVEL=INFO

# Log format: json or text
# Production recommendation: json (for structured logging)
LOG_FORMAT=json

# Log output: stdout, stderr, or file path
LOG_OUTPUT=stdout

# ============================================================================
# SECURITY CONFIGURATION
# ============================================================================

# API Key for service authentication (optional, recommended for production)
# Load from Docker secrets instead: /run/secrets/api_key
# CHROMA_API_KEY_FILE=/run/secrets/api_key

# TLS/SSL Configuration (when enabled)
# CHROMA_USE_TLS=true
# CHROMA_TLS_VERIFY=true
# CHROMA_TLS_CA_BUNDLE=/secrets/certs/ca-bundle.crt

# Encryption at rest (when implemented)
# ENCRYPTION_KEY_FILE=/run/secrets/encryption_key

# ============================================================================
# RATE LIMITING CONFIGURATION
# ============================================================================

# Enable rate limiting
RATE_LIMITING_ENABLED=true

# Rate limit: append_history (requests per minute)
RATE_LIMIT_APPEND_HISTORY=100

# Rate limit: write_memory (requests per minute)
RATE_LIMIT_WRITE_MEMORY=10

# Rate limit: recall_memory (requests per minute)
RATE_LIMIT_RECALL_MEMORY=50

# Rate limit: build_context (requests per minute)
RATE_LIMIT_BUILD_CONTEXT=30

# ============================================================================
# PERFORMANCE CONFIGURATION
# ============================================================================

# HTTP client timeout (seconds)
HTTP_TIMEOUT=30

# Maximum concurrent requests
MAX_CONCURRENT_REQUESTS=10

# Connection pool size
CONNECTION_POOL_SIZE=20

# Enable request caching
ENABLE_CACHING=true

# Cache TTL (seconds)
CACHE_TTL=300

# ============================================================================
# MONITORING CONFIGURATION
# ============================================================================

# Enable Prometheus metrics
METRICS_ENABLED=false

# Metrics endpoint port
METRICS_PORT=9090

# Enable health check endpoint
HEALTH_CHECK_ENABLED=true

# Health check port
HEALTH_CHECK_PORT=8081

# ============================================================================
# DATABASE CONFIGURATION
# ============================================================================

# ChromaDB HTTP configuration
CHROMA_HTTP_HOST=chroma
CHROMA_HTTP_PORT=8000
CHROMA_HTTP_PROTOCOL=http

# ChromaDB client configuration
CHROMA_CLIENT_TYPE=http

# ============================================================================
# BACKUP CONFIGURATION
# ============================================================================

# Backup directory for ChromaDB data
BACKUP_DIR=/data/backups/mcp-memory

# Backup retention (days)
BACKUP_RETENTION_DAYS=30

# Enable automatic backups
BACKUP_ENABLED=true

# Backup schedule (cron format)
BACKUP_SCHEDULE="0 2 * * *"

# ============================================================================
# FEATURE FLAGS
# ============================================================================

# Enable experimental features
ENABLE_EXPERIMENTAL_FEATURES=false

# Enable debug mode (DO NOT enable in production)
DEBUG_MODE=false

# Enable profiling
ENABLE_PROFILING=false

# ============================================================================
# ENVIRONMENT METADATA
# ============================================================================

# Environment name
ENVIRONMENT=production

# Deployment date
DEPLOYMENT_DATE=2025-12-25

# Deployment version
DEPLOYMENT_VERSION=1.0.0

# ============================================================================
# NOTES
# ============================================================================
#
# Security Best Practices:
# 1. Never commit this file with actual secrets
# 2. Use Docker secrets for sensitive values
# 3. Rotate credentials regularly
# 4. Use read-only file permissions (chmod 600)
# 5. Enable TLS for all inter-service communication
#
# Performance Tips:
# 1. Tune memory limits based on actual usage
# 2. Monitor logs for rate limiting events
# 3. Adjust MEMORY_TOP_K based on recall quality
# 4. Enable caching for production workloads
#
# Monitoring:
# 1. Set up log aggregation (ELK, Splunk, DataDog)
# 2. Configure alerting for errors
# 3. Monitor resource usage (CPU, memory, disk)
# 4. Track request latencies
#
